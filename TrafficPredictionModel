import pandas as pd
import matplotlib.pyplot as plt
import sys

sys._enablelegacywindowsfsencoding()
# with open("gbgData_201401.csv", 'r') as fp:
#     dum1 = pd.read_csv(fp, sep=";", decimal=",",  encoding="utf-8", names=["DetectorID",
#           "VehicleClassID", "Timestamp", "Flow", "Speed", "Occupancy", "Confidence", "Tdiff"
#           "TimeCycle", "NoVehicles", "Headway", "MeasuresIncluded"], index_col=False)
#
# dataShape = dum1.shape
# print(dataShape)


detectorRows = pd.DataFrame(columns=["DetectorID",
           "VehicleClassID", "Timestamp", "Flow", "Speed", "Occupancy", "Confidence", "Tdiff"
           "TimeCycle", "NoVehicles", "Headway", "MeasuresIncluded"])
booleans = []
i = 1
for chunk in pd.read_csv("gbgData_201401.csv", sep=";", decimal=",", encoding="utf-8", chunksize=1000000, names=["DetectorID",
           "VehicleClassID", "Timestamp", "Flow", "Speed", "Occupancy", "Confidence", "Tdiff"
           "TimeCycle", "NoVehicles", "Headway", "MeasuresIncluded"], index_col=False):
    print("handling chunk: " + repr(i))
    i = i+1
    booleans.clear()
    for detId in chunk.DetectorID:
        if detId == 20000:
          booleans.append(True)
        else:
          booleans.append(False)
    detectorRows.append(chunk[booleans], ignore_index=True)
    print(chunk[booleans])

print(detectorRows)

# push test

# booleans = []
# for detId in dum1.DetectorID:
#  if detId == 20000:
#      booleans.append(True)
#  else:
#      booleans.append(False)
#
# print(len(booleans))
#
# indices = pd.Series(booleans)
#
# print(dum1[indices])
#print(dum1)